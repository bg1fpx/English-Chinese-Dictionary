<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>English-Chinese Dictionary</title>

<style type="text/css">
body { background:white;
       color:black; }
body, p, td, input, button, a, li { font:14px/170% Tahoma; }
p { text-align:center; }
table {	margin:auto;
        width:1%; }
td { border-width:0px;
     vertical-align:bottom;
     white-space:nowrap; }
a:link, a:active, a:visited { color:blue;
                              text-decoration:none; }
a:hover { color:red; }
li { list-style:square; } /* used in search.php */
input.keyword { height:24px;
                width:200px; }
button.command { height:30px;
                 width:58px; }
td.center { text-align:center; }
</style>

<script type="text/javascript">
String.prototype.trim = function()
{ return this.replace(/(^\s*)|(\s*$)/g, ""); }

var mode = "smode";
var lastmode = mode;
var lastword = "";

function shortcut(event) // ---------- shortcut ----------
{ var key = event.keyCode || event.which; // Firefox

  if (key == 13) // enter
    search();
  if (key == 27) // escape
    erase(); }

function search() // ---------- search ----------
{ var word, re, request, data;

  document.getElementById("keyword").value = document.getElementById("keyword").value.trim();
  word = document.getElementById("keyword").value.toLowerCase();
  if (mode == lastmode && word == lastword)
    return false
  else
  { lastmode = mode;
    lastword = word; }

  re = /^[a-zA-Z]+$/;
  if (word == "" || (word.length < 3 && re.test(word) == true))
  { document.getElementById("result").innerHTML = "Please enter at least 3 English letters or 1 Chinese character.";
    return false; }

  request = new XMLHttpRequest();

  request.onreadystatechange = function()
  { if (request.readyState == 4 && request.status == 200)
      document.getElementById("result").innerHTML = request.responseText
    else
      document.getElementById("result").innerHTML = "Searching ..."; }

  request.onerror = function()
  { document.getElementById("result").innerHTML = "Service is temporarily unavailable, please try again later.";
    lastword = ""; }

  request.open("POST", "search.php", true);
  request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=utf-8");

  // timeout must be set between open() and send() in IE
  request.timeout = 10000;
  request.ontimeout = request.onerror;

  data = "keyword=" + document.getElementById("keyword").value + "&mode=" + mode;
  request.send(data); }

function erase() // ---------- erase ----------
{ document.getElementById("keyword").value = ""; }

function help() // ---------- help ----------
{ var message;

  message = "&nbsp;&nbsp; This is a minimalistic and bidirectional dictionary. You can enter an English keyword<br />to search for the equivalent Chinese word(s), and vice versa.<br />";
  message += "&nbsp;&nbsp; There are two search modes:<br />";
  message += "&nbsp;&nbsp; (1) Smode (starting mode): search for all the words starting with the keyword,<br />for example, roo &gt; roof | room | root.<br />";
  message += "&nbsp;&nbsp; (2) Cmode (containing mode): search for all the words containing the keyword,<br />for example, oos &gt; goose | loose | moose.<br />";
  message += "&nbsp;&nbsp; There are also two shortcut keys:<br />";
  message += "&nbsp;&nbsp; (1) Press Enter key to search for the keyword, instead of Search button.<br />";
  message += "&nbsp;&nbsp; (2) Press Escape key to erase the keyword, instead of Erase button.<br />";
  message += "&nbsp;&nbsp; The search is case-insensitive, for example, china &gt; China | china.<br />";
  message += "&nbsp;&nbsp; Before search, you must enter at least 3 English letters or 1 Chinese character,<br />for example, pia | pian | piano &gt; piano.<br />";
  message += "&nbsp;&nbsp; If your keyword is not found, you can send it to me (app@italian.org.cn) for<br />next-time dictionary update.";
  document.getElementById("result").innerHTML = message; }
</script>
</head>

<body>

<p>English-Chinese Dictionary</p> <!---------- Header ---------->

<p><table> <!---------- Keyword ---------->
<tr><td>
<input type="text" id="keyword" class="keyword" maxlength="20" onkeyup="shortcut(event)" />
</td>

<td>
<button type="button" class="command" onclick="search()">Search</button>
<button type="button" class="command" onclick="erase()">Erase</button>
<a href="javascript:void(0)" onclick="help()"><sup>[Help]</sup></a>
</td></tr>

<tr><td class="center">
<input type="radio" name="mode" onclick="mode='smode'" checked="checked" /> Smode
<input type="radio" name="mode" onclick="mode='imode'" /> Cmode
</td>

<td>
&nbsp;
</td></tr>
</table></p>

<p><table> <!---------- Result ---------->
<tr><td id="result">&nbsp;</td></tr>
</table></p>

<script type="text/javascript"> <!---------- Footer ---------->
var today = new Date();
document.writeln("<p>© " + today.getFullYear() + " <a href='http://www.italian.org.cn/app/' target='_blank'>Zhang Hong</a><br />");
document.writeln("<a href='https://www.paypal.me/zhanqhonq' target='_blank'>Donate with Paypal</a></p>");
</script>

</body>
</html>